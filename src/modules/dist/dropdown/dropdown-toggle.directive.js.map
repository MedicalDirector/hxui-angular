{"version":3,"file":"dropdown-toggle.directive.js","sourceRoot":"","sources":["../../dropdown/dropdown-toggle.directive.ts"],"names":[],"mappings":"AAAA,OAAO,EACL,SAAS,EAAE,UAAU,EAAE,WAAW,EAAE,YAAY,EAAE,SAAS,EAAE,SAAS,EACvE,MAAM,eAAe,CAAC;AACvB,OAAO,EAAE,YAAY,EAAE,MAAM,mBAAmB,CAAC;AAEjD,OAAO,EAAE,aAAa,EAAE,MAAM,kBAAkB,CAAC;;IAuD/C,iCAAoB,MAAqB,EACrB,QAAoB,EACpB,SAAoB;QAFxC,iBAUC;QAVmB,WAAM,GAAN,MAAM,CAAe;QACrB,aAAQ,GAAR,QAAQ,CAAY;QACpB,cAAS,GAAT,SAAS,CAAW;8BAJC,EAAE;;QAMzC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM;aACjC,YAAY,CAAC,SAAS,CAAC,UAAC,KAAc,IAAK,OAAA,KAAI,CAAC,MAAM,GAAG,KAAK,EAAnB,CAAmB,CAAC,CAAC,CAAC;;QAEpE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM;aACjC,gBAAgB;aAChB,SAAS,CAAC,UAAC,KAAc,IAAK,OAAA,KAAI,CAAC,UAAU,GAAG,KAAK,IAAI,KAAK,EAAhC,CAAgC,CAAC,CAAC,CAAC;KACrE;IAnDD,yCAAO,aAAC,KAAU;;QAChB,KAAK,CAAC,eAAe,EAAE,CAAC;QACxB,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;YACpB,MAAM,CAAC;SACR;;QAGD,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;;YAExB,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;SAChC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YAC7E,IAAM,0BAAwB,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,EAAE,OAAO,EAAE;;gBAE1E,AADF,gEAAgE;gBAC9D,KAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACpC,0BAAwB,EAAE,CAAC;aAC5B,CAAC,CAAC;SAEJ;;;;;;;;;;;IAcH,uCAAK;;;;;;;;;;;QACH,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;YAC1B,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACrC;;IAiBH,6CAAW,GAAX;QACE,GAAG,CAAC,CAAc,UAAmB,EAAnB,KAAA,IAAI,CAAC,cAAc,EAAnB,cAAmB,EAAnB,IAAmB;YAAhC,IAAM,GAAG,SAAA;YACZ,GAAG,CAAC,WAAW,EAAE,CAAC;SACnB;KACF;;gBArEF,SAAS,SAAC;oBACT,QAAQ,EAAE,qCAAqC;oBAC/C,QAAQ,EAAE,oBAAoB;iBAC/B;;;;gBALQ,aAAa;gBAJT,UAAU;gBAAwC,SAAS;;;+BAWrE,WAAW,SAAC,eAAe;2BAG3B,WAAW,SAAC,iBAAiB,cAC7B,WAAW,SAAC,oBAAoB;4BAEhC,YAAY,SAAC,OAAO,EAAE,CAAC,QAAQ,CAAC;0BAiChC,YAAY,SAAC,WAAW;;kCAnD3B;;SAWa,uBAAuB","sourcesContent":["import {\n  Directive, ElementRef, HostBinding, HostListener, OnDestroy, Renderer2\n} from '@angular/core';\nimport { Subscription } from 'rxjs/Subscription';\n\nimport { DropdownState } from './dropdown.state';\n\n@Directive({\n  selector: '[hxDropdownToggle],[dropdownToggle]',\n  exportAs: 'hx-dropdown-toggle'\n})\nexport class DropdownToggleDirective implements OnDestroy {\n  @HostBinding('attr.disabled')\n  isDisabled: boolean;\n\n  @HostBinding('class.is-active')\n  @HostBinding('attr.aria-expanded') isOpen: boolean;\n\n  @HostListener('click', ['$event'])\n  onClick(event: any): void {\n    event.stopPropagation();\n    if (this.isDisabled) {\n      return;\n    }\n\n    // console.log(this._state.isOpen);\n    if (!this._state.isOpen) {\n     // console.log('click to open');\n      this._state.toggleClick.emit();\n    }\n\n    if (this._state.isOpen || this._element.nativeElement.contains(event.target)) {\n      const removeRegisteredListener = this._renderer.listen('document', 'click', () => {\n      //  console.log('the document was clicked', this._state.isOpen);\n        this._state.toggleClick.emit(false);\n        removeRegisteredListener();\n      });\n\n    }\n  }\n\n  // Performance issue with multiple document listeners\n  /*@HostListener('document:click', ['$event'])\n  onDocumentClick(event: any): void {\n    if (this._state.autoClose && event.button !== 2 &&\n      !this._element.nativeElement.contains(event.target)) {\n      console.log('document:click');\n      this._state.toggleClick.emit(false);\n    }\n  }*/\n\n  @HostListener('keyup.esc')\n  onEsc(): void {\n    if (this._state.autoClose) {\n      this._state.toggleClick.emit(false);\n    }\n  }\n\n  private _subscriptions: Subscription[] = [];\n\n  constructor(private _state: DropdownState,\n              private _element: ElementRef,\n              private _renderer: Renderer2) {\n    // sync is open value with state\n    this._subscriptions.push(this._state\n      .isOpenChange.subscribe((value: boolean) => this.isOpen = value));\n    // populate disabled state\n    this._subscriptions.push(this._state\n      .isDisabledChange\n      .subscribe((value: boolean) => this.isDisabled = value || false));\n  }\n\n  ngOnDestroy(): void {\n    for (const sub of this._subscriptions) {\n      sub.unsubscribe();\n    }\n  }\n}\n"]}