{"version":3,"file":"typeahead-container.component.js","sourceRoot":"","sources":["../../typeahead/typeahead-container.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component, ElementRef, TemplateRef, ViewEncapsulation, HostListener\n} from '@angular/core';\nimport { TypeaheadDirective } from './typeahead.directive';\nimport { TypeaheadMatch } from './typeahead-match.class';\nimport { latinize } from './typeahead-utils';\n\n@Component({\n  selector: 'hx-typeahead-container',\n  // tslint:disable-next-line\n  template: `\n<!-- inject options list template -->\n<ng-template [ngTemplateOutlet]=\"optionsListTemplate || optionListTemplate\"\n  [ngTemplateOutletContext]=\"{matches:matches, itemTemplate:itemTemplate, query:query}\"></ng-template>\n\n<!-- default options item template -->\n<ng-template #hxItemTemplate let-match=\"match\" let-query=\"query\"><span [innerHtml]=\"hightlight(match, query)\"></span></ng-template>\n\n<!-- options list template -->\n<ng-template #optionListTemplate >\n<ng-template ngFor let-match let-i=\"index\" [ngForOf]=\"matches\">\n   <h6 *ngIf=\"match.isHeader()\" class=\"hx-dropdown-header\">{{match}}</h6>\n   \n   <ng-template [ngIf]=\"!match.isHeader()\">\n      <a href=\"#\"\n        class=\"hx-dropdown-item\"\n        (click)=\"selectMatch(match, $event)\"\n        (mouseenter)=\"selectActive(match)\"\n        [class.active]=\"isActive(match)\">\n          <ng-template [ngTemplateOutlet]=\"itemTemplate || hxItemTemplate\" \n            [ngTemplateOutletContext]=\"{item:match.item, index:i, match:match, query:query}\"></ng-template>\n      </a>\n  </ng-template>\n</ng-template>\n</ng-template>\n`,\n  // tslint:disable\n  host: {\n    'class': 'hx-dropdown is-open hx-dropdown-menu',\n    style: 'position: absolute;display: block;'\n  },\n  // tslint: enable\n  encapsulation: ViewEncapsulation.None\n})\nexport class TypeaheadContainerComponent {\n  public parent: TypeaheadDirective;\n  public query: any;\n  public element: ElementRef;\n  public isFocused: boolean = false;\n  public top: string;\n  public left: string;\n  public display: string;\n  public placement: string;\n\n\n  protected _active: TypeaheadMatch;\n  protected _matches: TypeaheadMatch[] = [];\n\n  public constructor(element: ElementRef) {\n    this.element = element;\n  }\n\n  public get active(): TypeaheadMatch {\n    return this._active;\n  }\n\n  public get matches(): TypeaheadMatch[] {\n    return this._matches;\n  }\n\n  public set matches(value: TypeaheadMatch[]) {\n    this._matches = value;\n\n    if (this._matches.length > 0) {\n      this._active = this._matches[0];\n      if (this._active.isHeader()) {\n        this.nextActiveMatch();\n      }\n    }\n  }\n\n  public get optionsListTemplate(): TemplateRef<any> {\n    return this.parent ? this.parent.optionsListTemplate : undefined;\n  }\n\n  public get itemTemplate(): TemplateRef<any> {\n    return this.parent ? this.parent.typeaheadItemTemplate : undefined;\n  }\n\n  public selectActiveMatch(): void {\n    this.selectMatch(this._active);\n  }\n\n  public prevActiveMatch(): void {\n    let index = this.matches.indexOf(this._active);\n    this._active = this.matches[index - 1 < 0\n      ? this.matches.length - 1\n      : index - 1];\n    if (this._active.isHeader()) {\n      this.prevActiveMatch();\n    }\n\n  }\n\n  public nextActiveMatch(): void {\n    let index = this.matches.indexOf(this._active);\n    this._active = this.matches[index + 1 > this.matches.length - 1\n      ? 0\n      : index + 1];\n    if (this._active.isHeader()) {\n      this.nextActiveMatch();\n    }\n  }\n\n  public selectActive(value: TypeaheadMatch): void {\n    this.isFocused = true;\n    this._active = value;\n  }\n\n  public hightlight(match: TypeaheadMatch, query: any): string {\n    let itemStr: string = match.value;\n    let itemStrHelper: string = (this.parent && this.parent.typeaheadLatinize\n      ? latinize(itemStr)\n      : itemStr).toLowerCase();\n    let startIdx: number;\n    let tokenLen: number;\n    // Replaces the capture string with the same string inside of a \"strong\" tag\n    if (typeof query === 'object') {\n      let queryLen: number = query.length;\n      for (let i = 0; i < queryLen; i += 1) {\n        // query[i] is already latinized and lower case\n        startIdx = itemStrHelper.indexOf(query[i]);\n        tokenLen = query[i].length;\n        if (startIdx >= 0 && tokenLen > 0) {\n          itemStr = itemStr.substring(0, startIdx) + '<strong>' + itemStr.substring(startIdx, startIdx + tokenLen) + '</strong>' + itemStr.substring(startIdx + tokenLen);\n          itemStrHelper = itemStrHelper.substring(0, startIdx) + '        ' + ' '.repeat(tokenLen) + '         ' + itemStrHelper.substring(startIdx + tokenLen);\n        }\n      }\n    } else if (query) {\n      // query is already latinized and lower case\n      startIdx = itemStrHelper.indexOf(query);\n      tokenLen = query.length;\n      if (startIdx >= 0 && tokenLen > 0) {\n        itemStr = itemStr.substring(0, startIdx) + '<strong>' + itemStr.substring(startIdx, startIdx + tokenLen) + '</strong>' + itemStr.substring(startIdx + tokenLen);\n      }\n    }\n    return itemStr;\n  }\n\n  @HostListener('mouseleave')\n  @HostListener('blur')\n  public focusLost(): void {\n    this.isFocused = false;\n  }\n\n  public isActive(value: TypeaheadMatch): boolean {\n    return this._active === value;\n  }\n\n  public selectMatch(value: TypeaheadMatch, e: Event = void 0): boolean {\n    if (e) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n    this.parent.changeModel(value);\n    setTimeout(() =>\n      this.parent.typeaheadOnSelect.emit(value), 0\n    );\n    return false;\n  }\n}\n"]}